{% extends 'base.html' %}
{% load static %}


{% block content %}

<!-- Product Detail Start -->
<div class="container-fluid py-5">
    <a class="btn btn-primary" href="{% url 'products:update_product' product.pk %}">update product</a>
    <form action="{% url 'products:delete_product' product.pk %}" method="post">{% csrf_token %}
        <button class="btn btn-danger mt-3">delete product</button>
    </form>
    <div class="container py-5">
        <div class="row g-4">
            <!-- Product Image Gallery -->
            <div class="col-lg-6 wow fadeInLeft" data-wow-delay="0.1s">
                <div class="product-detail-img border rounded">
                    <div class="main-image mb-3">
                        {% if product.main_image %}
                            <img src="{{ product.main_image.url }}" class="img-fluid w-100 rounded" alt="{{ product.title }}" id="mainImage">
                        {% else %}
                            <img src="{% static 'img/default.jpg' %}" class="img-fluid w-100 rounded" alt="{{ product.title }}" id="mainImage">
                        {% endif %}

                        {% if product.on_sale %}
                            <div class="product-sale">sale</div>
                        {% elif product.new %}
                            <div class="product-new">New</div>
                        {% endif %}
                    </div>

                    <!-- Thumbnail Images -->
                    <div class="row g-2">
                        {% if product.image1 %}
                            <div class="col-3">
                                <img src="{{ product.image1.url }}" class="img-fluid rounded border thumbnail-img active" alt="Thumbnail 1" onclick="changeImage(this)">
                            </div>
                        {% endif %}
                        {% if product.image2 %}
                            <div class="col-3">
                                <img src="{{ product.image2.url }}" class="img-fluid rounded border thumbnail-img active" alt="Thumbnail 2" onclick="changeImage(this)">
                            </div>
                        {% endif %}
                        {% if product.image3 %}
                            <div class="col-3">
                                <img src="{{ product.image3.url }}" class="img-fluid rounded border thumbnail-img active" alt="Thumbnail 3" onclick="changeImage(this)">
                            </div>
                        {% endif %}
                        {% if product.image4 %}
                            <div class="col-3">
                                <img src="{{ product.image4.url }}" class="img-fluid rounded border thumbnail-img active" alt="Thumbnail 4" onclick="changeImage(this)">
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Product Information -->
            <div class="col-lg-6 wow fadeInRight" data-wow-delay="0.1s">
                <div class="product-detail-info">
                    <!-- Breadcrumb -->
                    <nav aria-label="breadcrumb mb-3">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="{% url 'products:index' %}">Home</a></li>
                            <li class="breadcrumb-item active" aria-current="page">{{ product.title }}</li>
                        </ol>
                    </nav>

                    <!-- Product Title -->
                    <h2 class="mb-3">{{ product.title }}</h2>

                    <!-- Rating -->
                    <div class="d-flex align-items-center mb-3">
                        <div class="d-flex me-3">
                            <i class="fas fa-star text-primary"></i>
                            <i class="fas fa-star text-primary"></i>
                            <i class="fas fa-star text-primary"></i>
                            <i class="fas fa-star text-primary"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <span class="text-muted">(24 Customer Reviews)</span>
                    </div>

                    <!-- Price -->
                    <div class="mb-4">
                        {% if product.on_sale %}
                            <del class="text-muted me-2 fs-4">${{ product.price }}</del>
                            <span class="text-primary fw-bold fs-3">${{ sale_price }}</span>
                            <span class="badge bg-danger ms-2">Save {{ product.sale }}%</span>
                        {% else %}
                            <span class="text-primary fw-bold fs-3">${{ product.price }}</span>
                        {% endif %}
                    </div>

                    <!-- Availability -->
<!--                    <div class="mb-3">-->
<!--                        <span class="fw-bold">Availability:</span>-->
<!--                        {% if product.in_stock %}-->
<!--                            <span class="text-success ms-2"><i class="fas fa-check-circle"></i> In Stock</span>-->
<!--                        {% else %}-->
<!--                            <span class="text-danger ms-2"><i class="fas fa-times-circle"></i> Out of Stock</span>-->
<!--                        {% endif %}-->
<!--                    </div>-->

                    <!-- Category -->
                    <div class="mb-3">
                        <span class="fw-bold">Category:</span>
                        <a href="{% url 'products:category' product.category.title %}" class="text-primary ms-2">{{ product.category.title }}</a>
                    </div>

                    <!-- Short Description -->
                    <div class="mb-4">
                        <p class="text-muted">{{ product.description|truncatewords:30 }}</p>
                    </div>

                    <!-- Quantity Selector -->
                    <div class="mb-4">
                        <div class="d-flex align-items-center">
                            <span class="fw-bold me-3">Quantity:</span>
                            <div class="input-group quantity-selector" style="width: 150px;">
                                <button class="btn btn-outline-secondary" type="button" onclick="decreaseQuantity()">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <input type="text" class="form-control text-center" value="1" id="quantity" readonly>
                                <button class="btn btn-outline-secondary" type="button" onclick="increaseQuantity()">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="mb-4">
                        <div class="d-flex gap-3">
                            <button class="btn btn-primary border-secondary rounded-pill py-3 px-5 flex-grow-1">
                                <i class="fas fa-shopping-cart me-2"></i> Add To Cart
                            </button>
                            <form method="post" action="{% url 'products:add_to_wishlist' product.pk %}">{% csrf_token %}
                                <input type="hidden" name="next" value="{{ request.get_full_path }}">
                                <button class="btn btn-outline-primary rounded-pill py-3 px-4">
                                    <i class="fas fa-heart"></i>
                                </button>
                            </form>
                            <button class="btn btn-outline-primary rounded-pill py-3 px-4">
                                <i class="fas fa-random"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Additional Info -->
                    <div class="border-top pt-3">
                        <div class="row">
                            <div class="col-6 mb-2">
                                <i class="fas fa-truck text-primary me-2"></i>
                                <span class="text-muted">Free Delivery</span>
                            </div>
                            <div class="col-6 mb-2">
                                <i class="fas fa-undo text-primary me-2"></i>
                                <span class="text-muted">30 Days Return</span>
                            </div>
                            <div class="col-6 mb-2">
                                <i class="fas fa-shield-alt text-primary me-2"></i>
                                <span class="text-muted">Secure Payment</span>
                            </div>
                            <div class="col-6 mb-2">
                                <i class="fas fa-headset text-primary me-2"></i>
                                <span class="text-muted">24/7 Support</span>
                            </div>
                        </div>
                    </div>

                    <!-- Share -->
                    <div class="border-top pt-3 mt-3">
                        <span class="fw-bold me-3">Share:</span>
                        <a href="#" class="text-primary me-3"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="text-primary me-3"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="text-primary me-3"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="text-primary me-3"><i class="fab fa-pinterest"></i></a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Product Tabs -->
        <div class="row mt-5">
            <div class="col-12 wow fadeInUp" data-wow-delay="0.1s">
                <ul class="nav nav-pills mb-4 justify-content-center" id="pills-tab" role="tablist">
                    <li class="nav-item me-2" role="presentation">
                        <button class="nav-link active rounded-pill px-4 py-2" id="pills-description-tab" data-bs-toggle="pill" data-bs-target="#pills-description" type="button" role="tab">
                            Description
                        </button>
                    </li>
                    <li class="nav-item me-2" role="presentation">
                        <button class="nav-link rounded-pill px-4 py-2" id="pills-info-tab" data-bs-toggle="pill" data-bs-target="#pills-info" type="button" role="tab">
                            Additional Info
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link rounded-pill px-4 py-2" id="pills-reviews-tab" data-bs-toggle="pill" data-bs-target="#pills-reviews" type="button" role="tab">
                            Reviews (24)
                        </button>
                    </li>
                </ul>
                <div class="tab-content" id="pills-tabContent">
                    <!-- Description Tab -->
                    <div class="tab-pane fade show active" id="pills-description" role="tabpanel">
                        <div class="bg-light rounded p-4">
                            <h5 class="mb-3">Product Description</h5>
                            <p class="mb-3">{{ product.description }}</p>
                            <p class="mb-0">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris.</p>
                        </div>
                    </div>

                    <!-- Additional Info Tab -->
                    <div class="tab-pane fade" id="pills-info" role="tabpanel">
                        <div class="bg-light rounded p-4">
                            <h5 class="mb-3">Additional Information</h5>
                            <table class="table table-borderless">
                                <tbody>
                                    <tr>
                                        <td class="fw-bold" width="200">Weight</td>
                                        <td>1.2 kg</td>
                                    </tr>
                                    <tr>
                                        <td class="fw-bold">Dimensions</td>
                                        <td>20 × 15 × 10 cm</td>
                                    </tr>
                                    <tr>
                                        <td class="fw-bold">Material</td>
                                        <td>Premium Quality</td>
                                    </tr>
                                    <tr>
                                        <td class="fw-bold">Color</td>
                                        <td>Multiple Options</td>
                                    </tr>
                                    <tr>
                                        <td class="fw-bold">Brand</td>
                                        <td>{{ product.brand|default:"Generic" }}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Reviews Tab -->
                    <div class="tab-pane fade" id="pills-reviews" role="tabpanel">
                        <div class="bg-light rounded p-4">
                            <h5 class="mb-4">Customer Reviews</h5>

                            <!-- Review Item -->
                            <div class="review-item mb-4 pb-4 border-bottom">
                                <div class="d-flex justify-content-between mb-2">
                                    <div>
                                        <h6 class="mb-1">John Doe</h6>
                                        <div class="d-flex">
                                            <i class="fas fa-star text-primary"></i>
                                            <i class="fas fa-star text-primary"></i>
                                            <i class="fas fa-star text-primary"></i>
                                            <i class="fas fa-star text-primary"></i>
                                            <i class="fas fa-star text-primary"></i>
                                        </div>
                                    </div>
                                    <span class="text-muted">2 days ago</span>
                                </div>
                                <p class="mb-0">Great product! Exactly as described. Fast shipping and excellent quality. Highly recommended!</p>
                            </div>

                            <!-- Review Item -->
                            <div class="review-item mb-4 pb-4 border-bottom">
                                <div class="d-flex justify-content-between mb-2">
                                    <div>
                                        <h6 class="mb-1">Jane Smith</h6>
                                        <div class="d-flex">
                                            <i class="fas fa-star text-primary"></i>
                                            <i class="fas fa-star text-primary"></i>
                                            <i class="fas fa-star text-primary"></i>
                                            <i class="fas fa-star text-primary"></i>
                                            <i class="fas fa-star"></i>
                                        </div>
                                    </div>
                                    <span class="text-muted">1 week ago</span>
                                </div>
                                <p class="mb-0">Very satisfied with my purchase. Good value for money.</p>
                            </div>

                            <!-- Add Review Form -->
                            <div class="mt-4">
                                <h6 class="mb-3">Add Your Review</h6>
                                <form>
                                    <div class="mb-3">
                                        <label class="form-label">Your Rating</label>
                                        <div class="rating-stars">
                                            <i class="far fa-star fs-5 text-primary"></i>
                                            <i class="far fa-star fs-5 text-primary"></i>
                                            <i class="far fa-star fs-5 text-primary"></i>
                                            <i class="far fa-star fs-5 text-primary"></i>
                                            <i class="far fa-star fs-5 text-primary"></i>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Your Name</label>
                                        <input type="text" class="form-control rounded-pill" placeholder="Enter your name">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Your Review</label>
                                        <textarea class="form-control rounded" rows="4" placeholder="Write your review..."></textarea>
                                    </div>
                                    <button type="submit" class="btn btn-primary rounded-pill px-4 py-2">Submit Review</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Related Products -->
        <div class="row mt-5">
            <div class="col-12 wow fadeInUp" data-wow-delay="0.1s">
                <h3 class="mb-4">Related Products</h3>
                <div class="row g-4">
                    {% for related_product in related_products %}
                    <div class="col-md-6 col-lg-4 col-xl-3">
                        <div class="product-item rounded">
                            <div class="product-item-inner border rounded">
                                <div class="product-item-inner-item">
                                    <img src="{% static 'img/product-3.png' %}" class="img-fluid w-100 rounded-top" alt="">
                                    {% if related_product.on_sale %}
                                        <div class="product-sale">sale</div>
                                    {% elif related_product.new %}
                                        <div class="product-new">New</div>
                                    {% endif %}
                                    <div class="product-details">
                                        <a href="{% url 'products:details' related_product.pk %}"><i class="fa fa-eye fa-1x"></i></a>
                                    </div>
                                </div>
                                <div class="text-center rounded-bottom p-4">
                                    <a href="{% url 'products:category' related_product.category.title %}" class="d-block mb-2">{{ related_product.category.title }}</a>
                                    <a href="{% url 'products:details' related_product.pk %}" class="d-block h4">{{ related_product.title }}</a>
                                    {% if related_product.on_sale %}
                                    <del class="me-2 fs-5">${{ related_product.price }}</del>
                                    <span class="text-primary fs-5">${{ related_product.sale_price }}</span>
                                    {% else %}
                                    <span class="text-primary fs-5">${{ related_product.price }}</span>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Product Detail End -->

<script>
function changeImage(thumbnail) {
    const mainImage = document.getElementById('mainImage');
    mainImage.src = thumbnail.src;
    document.querySelectorAll('.thumbnail-img').forEach(img => img.classList.remove('active'));
    thumbnail.classList.add('active');
}

function increaseQuantity() {
    const quantityInput = document.getElementById('quantity');
    quantityInput.value = parseInt(quantityInput.value) + 1;
}

function decreaseQuantity() {
    const quantityInput = document.getElementById('quantity');
    let currentValue = parseInt(quantityInput.value);
    if (currentValue > 1) {
        quantityInput.value = currentValue - 1;
    }
}
</script>
{% endblock %}